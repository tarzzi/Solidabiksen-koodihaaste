<!--
Solidabiksen koodihaaste 2021

Tehtävänäsi on toteuttaa autoilumittari-sovellus. 
Sovelluksen tulee pystyä suorittamaan vertailu matka-ajan ja polttoaineen
kulutuksen välillä kahden eri valitun nopeuden mukaan: käyttäjä ilmoittaa 
saman matkustettavan etäisyyden samalla kulkuneuvotyypillä eri nopeuksilla 
ja sovellus laskee miten paljon nopeammin käyttäjä on perillä ja kuinka paljon 
enemmän polttoainetta tähän kuluu.

Toteuttanut:
Tarmo Urrio
https://urrio.fi
-->

<html lang="fi">
<head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oleo+Script+Swash+Caps&family=Open+Sans&display=swap" rel="stylesheet">
    <style>
        body{            
            font-family: 'Open Sans', sans-serif;
        }
        input {
            width: 6rem;
            height: 2rem;
            display: block;
            margin: 0 auto;
            font-size: 1.5rem;
        }
        .typebox{
            background-color: rgb(0,99,166);
            color: white;
            border: 1px solid white;
            border-radius: 100%;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            height: 20vh;
            width: 20vh;
            margin: auto;            
        }
        .infobox{
            border: outset;
            padding: 2rem;
            text-align: center;
        }
        #header{
            font-family: 'Oleo Script Swash Caps', cursive;
            font-size: 2rem;
            letter-spacing: 2px;
            padding: 1rem 0;
            background-color: lightblue;
            clip-path: polygon(0 0, 100% 0%, 100% 76%, 0 100%);
            text-align: center;
        }
        #container{
            width: 80%;
            margin: 0 auto;
            padding: 2rem 0;
        }
</style>
</head>
<body style="margin: 0">
    <div id="header"><h1>Solidabiksen koodihaaste</h1></div>
    <div id="container">
        <div style="display: grid; grid-template-columns: auto auto auto; text-align: center; font-size: 1.8rem;">
            <div class="typebox">    
                <label>Matka
                    <input type="number" id="matka"> Km
                </label>
            </div>
            <div class="typebox">    
                <label>Nopeus 1
                    <input type="number" id="nopeus1"> Km/h
                </label>
            </div>
            <div class="typebox">    
                <label>Nopeus 2
                    <input type="number" id="nopeus2"> Km/h
                </label>
            </div>
        </div>
        <div>
            <h2>Matka-aika</h2>
            <div style="display: grid; grid-template-columns: auto auto auto; column-gap: 1rem;">
                <div class="infobox">Nopeudella 1 <br><span id="aika1" style="font-weight: bold;"></span></div>
                <div class="infobox"><span id="infoAika" style="font-weight: bold;"></span><br><br></div>
                <div class="infobox">Nopeudella 2<br><br> <span id="aika2" style="font-weight: bold;"></span></div>
            </div>
        </div>
        <div>
            <h2>Polttoaineen kulutus</h2>
            <div style="display: grid; grid-template-columns: auto auto auto; column-gap: 1rem;">
                <div class="infobox">
                    Auto A - 3L/100km<br><br>
                    <span id="kulutusA1"></span><br><br>
                    <span id="kulutusA2"></span><br><br>
                    <span id="infoAk" style="font-weight: bold;"></span>
                </div>
                <div class="infobox">
                    Auto B - 3.5L/100km <br><br>
                    <span id="kulutusB1"></span><br><br>
                    <span id="kulutusB2"></span><br><br>
                    <span id="infoBk" style="font-weight: bold;"></span>
                </div>
                <div class="infobox">
                    Auto C - 4L/100km <br><br>
                    <span id="kulutusC1"></span><br><br>
                    <span id="kulutusC2"></span><br><br>
                    <span id="infoCk" style="font-weight: bold;"></span>
                </div>
            </div>
        </div>
    </div>
    <script src="jquery-3.6.0.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
        $("input").on("keyup change",(function () {
        Laske();
        }));

        function Laske(){
            // init values
            let matka = $("#matka").val();
            matka = Number(matka);
            let nopeus1 = $("#nopeus1").val();
            nopeus1 = Number(nopeus1);
            let nopeus2 = $("#nopeus2").val();
            nopeus2 = Number(nopeus2);

            // calculate elapsed time
            matka_aika1 = matka / nopeus1;
            matka_aika2 = matka / nopeus2;
            let ajat1 = KulunutAika(matka_aika1); 
            let ajat2 = KulunutAika(matka_aika2);
            let yksiH = ajat1[0];
            let yksiMin = ajat1[1];
            let kaksiH = ajat2[0];
            let kaksiMin = ajat2[1];
            yksiMin = Number(yksiMin.toFixed(0));
            kaksiMin = Number(kaksiMin.toFixed(0));

            // display time 
            if(Number(nopeus1)){ $("#aika1").text(nopeus1 + "km/h " + yksiH + "h " + yksiMin + "min");}
            else if(nopeus2 == 0){ $("#aika2").text(nopeus2 + "km/h pysyt paikallasi");}
            if(Number(nopeus2)){ $("#aika2").text(nopeus2 + "km/h " + kaksiH + "h " + kaksiMin + "min");}
            else if(nopeus2 == 0){ $("#aika2").text(nopeus2 + "km/h pysyt paikallasi");}

            if(yksiH < kaksiH && yksiMin > kaksiMin){
                difmin = 60 - yksiMin + kaksiMin;
                difh = kaksiH - yksiH - 1;
            }
            else if(yksiH > kaksiH && yksiMin < kaksiMin){
                difmin = 60 - yksiMin + kaksiMin;
                difh = yksiH - kaksiH - 1;
            }
            else{
                difh = yksiH - kaksiH;
                difmin = yksiMin - kaksiMin;

            }
            difh = Math.abs(difh);
            difmin = Math.abs(difmin);
            if(Number(difmin)){ $("#infoAika").html("Matka nopeutui " + difh +  " h " + difmin + " minuuttia");}
            else if(difmin == 0 && difh == 0){$("#infoAika").html("Nopeudet ovat samat");}

            // calculate consumption
            let kulutusA = Kulutus(nopeus1, nopeus2, "a");
            let kulutusB = Kulutus(nopeus1, nopeus2, "b");
            let kulutusC = Kulutus(nopeus1, nopeus2, "c");

            //display consumption
            if(Number(kulutusA[0])){ $("#kulutusA1").html(nopeus1 +"km/h "+ kulutusA[0] + " L/100kmh");}
            if(Number(kulutusA[0])){ $("#kulutusA2").html(nopeus2 +"km/h "+ kulutusA[1] + " L/100kmh");}
            if(Number(kulutusB[0])){ $("#kulutusB1").html(nopeus1 +"km/h "+ kulutusB[0] + " L/100kmh");}
            if(Number(kulutusB[0])){ $("#kulutusB2").html(nopeus2 +"km/h "+ kulutusB[1] + " L/100kmh");}
            if(Number(kulutusC[0])){ $("#kulutusC1").html(nopeus1 +"km/h "+ kulutusC[0] + " L/100kmh");}
            if(Number(kulutusC[0])){ $("#kulutusC2").html(nopeus2 +"km/h "+ kulutusC[1] + " L/100kmh");}

            // elaborate results
            let litraeroA = Kulutusero(kulutusA[0], kulutusA[1], matka);
            let litraeroB = Kulutusero(kulutusB[0], kulutusB[1], matka);
            let litraeroC = Kulutusero(kulutusC[0], kulutusC[1], matka);
            
            if(Number(litraeroA)){ $("#infoAk").html("Auto kulutti bensaa " + litraeroA + " litraa enemmän");}
            if(Number(litraeroB)){ $("#infoBk").html("Auto kulutti bensaa " + litraeroB + " litraa enemmän");}
            if(Number(litraeroC)){ $("#infoCk").html("Auto kulutti bensaa " + litraeroC + " litraa enemmän");}


        }
        
        function KulunutAika(matka_aika){
            let tunnit = matka_aika.toFixed(0);
            let minuutit = (matka_aika - tunnit) * 60;
            minuutit = minuutit.toFixed(0);
            minuutit = Math.abs(minuutit);
            tunnit = Math.abs(tunnit);
            return [tunnit, minuutit];
            
        }

        function Kulutus(nopeus1, nopeus2, auto){
            const autoA = 3;
            const autoB = 3.5;
            const autoC = 4;
            const kulmakerroin = 1.009
            let kulutus;
            switch(auto){
                case "a":
                    kulutus = autoA;
                    break;
                case "b":
                    kulutus = autoB;
                    break;
                case "c":
                    kulutus = autoC;
                    break;                
            }
            let kulutus1 = kulutus * (kulmakerroin ** nopeus1);
            kulutus1 = kulutus1.toFixed(2);
            let kulutus2 = kulutus * (kulmakerroin ** nopeus2); 
            kulutus2 = kulutus2.toFixed(2);
            return [kulutus1, kulutus2]
        }

        function Kulutusero(kulutus1, kulutus2, matka){
            let litraero = kulutus1 - kulutus2;  
            litraero = litraero * matka / 100;
            litraero = Math.abs(litraero);
            litraero = Number(litraero.toFixed(2));       
            return litraero;            
        }
    });
    </script>
</body>
</html>