<!--
Solidabiksen koodihaaste 2021

Tehtävänäsi on toteuttaa autoilumittari-sovellus. 
Sovelluksen tulee pystyä suorittamaan vertailu matka-ajan ja polttoaineen
kulutuksen välillä kahden eri valitun nopeuden mukaan: käyttäjä ilmoittaa 
saman matkustettavan etäisyyden samalla kulkuneuvotyypillä eri nopeuksilla 
ja sovellus laskee miten paljon nopeammin käyttäjä on perillä ja kuinka paljon 
enemmän polttoainetta tähän kuluu.

Toteuttanut:
Tarmo Urrio
https://urrio.fi
-->

<html lang="fi">
<head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Oleo+Script+Swash+Caps&family=Open+Sans&display=swap" rel="stylesheet">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
        body{            
            font-family: 'Open Sans', sans-serif;
        }    
        h2{
            background-color: rgb(0,151,117);
            color: white;
            padding: 1rem;
            border: 0.3rem solid white;
            border-radius:1rem;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.329);            
        } 
        h3{
            background-color: rgb(0,99,166);
            color: white;
            border: 1px solid white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.329);  
            padding: 0.3rem 0;
        }        
        input {
            width: 6rem;
            height: 2rem;
            display: block;
            margin: 0 auto;
            font-size: 1.5rem;
        }
        #breaking{
            background-color: rgb(255,204,1);
            color: black;
            border: 3px solid rgb(228, 1, 44);
        }
        #header{
            font-family: 'Oleo Script Swash Caps', cursive;
            font-size: 2rem;
            letter-spacing: 2px;
            padding: 1rem 0;
            background-color: lightblue;
            clip-path: polygon(0 0, 100% 0%, 100% 76%, 0 100%);
            text-align: center;
        }
        #container{
            width: 80%;
            margin: 0 auto;
            padding: 2rem 0;
        }
        .blue-bg{            
            background-color: rgb(0,99,166);
            color: white;
            border: 1px solid white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.329);  
        }
        .grid-container{
            display: grid; 
            grid-template-columns: auto auto auto; 
            text-align: center; 
            font-size: 1.6rem; 
        }
        .typebox{
            background-color: rgb(0,99,166);
            color: white;
            border: 1px solid white;
            border-radius: 100%;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.329);   
            height: 10rem;
            width: 10rem;
            margin: auto;
            text-align: center;
            display:flex;
            align-items:center;
            justify-content: center;
        }
        .info-grid{
            display: grid;
            grid-template-columns: auto auto auto; 
            column-gap: 1rem;
        }
        .infobox{
            border: outset;
            padding: 2rem;
            text-align: center;
        }
        .hidden{
            display: none;
        }
</style>
</head>
<body style="margin: 0">
    <div id="header"><h1 class="animate__animated animate__lightSpeedInLeft">Autoilumittari </h1></div>
    <div id="container">
        <div class="grid-container">
            <div class="typebox">
                <label>Matka
                    <input type="number" id="matka"> Km
                </label>
            </div>
            <div class="typebox">    
                <label>Nopeus 1
                    <input type="number" id="nopeus1"> Km/h
                </label>
            </div>
            <div class="typebox">    
                <label>Nopeus 2
                    <input type="number" id="nopeus2"> Km/h
                </label>
            </div>
        </div>
        <div>
            <h2>Matka-aika</h2>
            <div class="info-grid hidden" id="time">
                <div class="infobox"><h3 class="blue-bg">Nopeudella 1<span id="aika1" style="font-weight: bold;"></span></h3></div>
                <div class="infobox">
                    <h3>Aikaero</h3>
                    <span id="infoAika" style="font-weight: bold;"></span>
                    <h3 id="breaking">Jarrutusmatka kasvoi
                        <span id="infoJarru" style="font-weight: bold;"></span>
                    </h3>
                </div>
                <div class="infobox"><h3>Nopeudella 2</h3> <span id="aika2" style="font-weight: bold;"></span></div>
            </div>
        </div>
        <div>
            <h2>Polttoaineen kulutus</h2>
            <div class="info-grid hidden" id="fuel">
                <div class="infobox">
                    <h3>Auto A - 3L/100km</h3>
                    <div style="display: grid; grid-template-columns: auto auto;">
                        <span id="kulutusA1"></span>
                        <span id="kulutusA2"></span>
                    </div>
                    <span id="infoAk" style="font-weight: bold;"></span>
                </div>
                <div class="infobox">
                    <h3>Auto B - 3.5L/100km</h3>
                    <span id="kulutusB1"></span><br><br>
                    <span id="kulutusB2"></span><br><br>
                    <span id="infoBk" style="font-weight: bold;"></span>
                </div>
                <div class="infobox">
                    <h3>Auto C - 4L/100km</h3>
                    <span id="kulutusC1"></span><br><br>
                    <span id="kulutusC2"></span><br><br>
                    <span id="infoCk" style="font-weight: bold;"></span>
                </div>
            </div>
        </div>
    </div>
    <script src="jquery-3.6.0.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
        $("input").on("keyup change",(function () {
            //animations
            if($("#time").hasClass("hidden") ){
                $("#time").removeClass("hidden"); 
                $("#fuel").removeClass("hidden");}
            $(".fade-in").addClass("animate__animated, animate__fadeIn");
            //calculations
            Laske();
        }));

        function Laske(){
            // init values
            let matka = $("#matka").val();
            matka = Number(matka);
            let nopeus1 = $("#nopeus1").val();
            nopeus1 = Number(nopeus1);
            let nopeus2 = $("#nopeus2").val();
            nopeus2 = Number(nopeus2);

            // calculate elapsed time
            matka_aika1 = matka / nopeus1;
            matka_aika2 = matka / nopeus2;
            let ajat1 = KulunutAika(matka_aika1); 
            let ajat2 = KulunutAika(matka_aika2);
            let yksiH = ajat1[0];
            let yksiMin = ajat1[1];
            let kaksiH = ajat2[0];
            let kaksiMin = ajat2[1];
            yksiMin = Number(yksiMin.toFixed(0));
            kaksiMin = Number(kaksiMin.toFixed(0));

            // display time 
            if(Number(nopeus1)){ $("#aika1").text(nopeus1 + "km/h " + yksiH + "h " + yksiMin + "min");}
            else if(nopeus1 == 0){ $("#aika1").text(nopeus1 + "km/h pysyt paikallasi");}
            if(Number(nopeus2)){ $("#aika2").text(nopeus2 + "km/h " + kaksiH + "h " + kaksiMin + "min");}
            else if(nopeus2 == 0){ $("#aika2").text(nopeus2 + "km/h pysyt paikallasi");}

            if(yksiH < kaksiH && yksiMin > kaksiMin){
                difmin = 60 - yksiMin + kaksiMin;
                difh = kaksiH - yksiH - 1;
            }
            else if(yksiH > kaksiH && yksiMin < kaksiMin){
                difmin = 60 - yksiMin + kaksiMin;
                difh = yksiH - kaksiH - 1;
            }
            else{
                difh = yksiH - kaksiH;
                difmin = yksiMin - kaksiMin;

            }
            difh = Math.abs(difh);
            difmin = Math.abs(difmin);
            if(Number(difmin)){ $("#infoAika").html(difh +  " h " + difmin + " minuuttia");}
            else if(difmin == 0 && difh == 0){$("#infoAika").html("Nopeudet ovat samat");}

            // calculate consumption
            let kulutusA = Kulutus(nopeus1, nopeus2, "a");
            let kulutusB = Kulutus(nopeus1, nopeus2, "b");
            let kulutusC = Kulutus(nopeus1, nopeus2, "c");

            //display consumption
            if(Number(kulutusA[0])){ $("#kulutusA1").html(nopeus1 +"km/h "+ kulutusA[0] + " L/100km");}
            if(Number(kulutusA[0])){ $("#kulutusA2").html(nopeus2 +"km/h "+ kulutusA[1] + " L/100kh");}
            if(Number(kulutusB[0])){ $("#kulutusB1").html(nopeus1 +"km/h "+ kulutusB[0] + " L/100kh");}
            if(Number(kulutusB[0])){ $("#kulutusB2").html(nopeus2 +"km/h "+ kulutusB[1] + " L/100km");}
            if(Number(kulutusC[0])){ $("#kulutusC1").html(nopeus1 +"km/h "+ kulutusC[0] + " L/100km");}
            if(Number(kulutusC[0])){ $("#kulutusC2").html(nopeus2 +"km/h "+ kulutusC[1] + " L/100km");}

            // elaborate results
            let litraeroA = Kulutusero(kulutusA[0], kulutusA[1], matka);
            let litraeroB = Kulutusero(kulutusB[0], kulutusB[1], matka);
            let litraeroC = Kulutusero(kulutusC[0], kulutusC[1], matka);
            
            if(Number(litraeroA)){ $("#infoAk").html("Polttoainetta kului " + litraeroA + " litraa enemmän");}
            if(Number(litraeroB)){ $("#infoBk").html("Polttoainetta kului " + litraeroB + " litraa enemmän");}
            if(Number(litraeroC)){ $("#infoCk").html("Polttoainetta kului " + litraeroC + " litraa enemmän");}

            /*
            Jarrtusmatkan laskenta
            (Nopeus / 10 * nopeus / 10)/ 2
            Reaktioajan laskenta
            (Nopeus / 10) * 3
            */
            let jarrutus1 = Jarrutusmatka(nopeus1);
            let jarrutus2 = Jarrutusmatka(nopeus2);
            let jarrutusero = Math.abs(jarrutus1 - jarrutus2);
            jarrutusero = jarrutusero.toFixed(0);
            if(Number(jarrutusero)){$("#infoJarru").text(jarrutusero + " metriä");}
        }

        function Jarrutusmatka(nopeus){
            let jarrutus = (nopeus / 10) * (nopeus / 10) / 2;
            let reaktio = nopeus / 10 * 3;
            jarrutus += reaktio;
            return jarrutus;
        }

        function KulunutAika(matka_aika){
            let tunnit = matka_aika.toFixed(0);
            let minuutit = (matka_aika - tunnit) * 60;
            minuutit = minuutit.toFixed(0);
            minuutit = Math.abs(minuutit);
            tunnit = Math.abs(tunnit);
            return [tunnit, minuutit];
            
        }

        function Kulutus(nopeus1, nopeus2, auto){
            const autoA = 3;
            const autoB = 3.5;
            const autoC = 4;
            const kulmakerroin = 1.009
            let kulutus;
            switch(auto){
                case "a":
                    kulutus = autoA;
                    break;
                case "b":
                    kulutus = autoB;
                    break;
                case "c":
                    kulutus = autoC;
                    break;                
            }
            let kulutus1 = kulutus * (kulmakerroin ** nopeus1);
            kulutus1 = kulutus1.toFixed(2);
            let kulutus2 = kulutus * (kulmakerroin ** nopeus2); 
            kulutus2 = kulutus2.toFixed(2);
            return [kulutus1, kulutus2]
        }

        function Kulutusero(kulutus1, kulutus2, matka){
            let litraero = kulutus1 - kulutus2;  
            litraero = litraero * matka / 100;
            litraero = Math.abs(litraero);
            litraero = Number(litraero.toFixed(2));       
            return litraero;            
        }
    });
    </script>
</body>
</html>